import sqlalcemy
import pandas as pd

#SQL Connection

#new server
SERVER = 'ServerName'
DATABASE = 'Test_database'

DRIVER = 'ODBC+Driver+17+for+SQL+Server'
DATABASE_CONNECTION = f'mssql+pyodbc://@{SERVER}/{DATABASE}?driver={DRIVER}'

#create engine   
engine_sql = sqlalchemy.create_engine(DATABASE_CONNECTION,fast_executemany=True)

#df - some dataframe

#LOAD DATAFRAME TO SERVER
#instead of remplace can use: 'append' and 'fail'
df.to_sql(test_table,schema="dbo",con=engine_sql,index=False,if_exists='replace') 


#GET DATA FROM SERVER
df_1 = pd.read_sql_query('''
select *
from
dbo.test_table
''', con = engine_sql)
